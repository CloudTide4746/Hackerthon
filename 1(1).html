<!-- @format -->

<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>视频理解助手 - 让视频内容一目了然</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", "Microsoft YaHei", sans-serif;
      }

      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: #333;
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1600px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 25px;
      }

      header {
        text-align: center;
        padding: 30px 25px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        backdrop-filter: blur(10px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        position: relative;
        overflow: hidden;
      }

      header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: linear-gradient(90deg, #667eea, #764ba2);
      }

      h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
        background: linear-gradient(90deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .tagline {
        font-size: 1.2rem;
        color: #666;
        margin-bottom: 10px;
      }

      .sub-tagline {
        font-size: 1rem;
        color: #888;
        max-width: 800px;
        margin: 0 auto;
        line-height: 1.5;
      }

      .main-content {
        display: flex;
        flex-wrap: wrap;
        gap: 25px;
      }

      .video-section {
        flex: 3;
        min-width: 300px;
      }

      .assistant-section {
        flex: 2;
        min-width: 300px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        display: flex;
        flex-direction: column;
      }

      .video-container {
        position: relative;
        background: #000;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.25);
        margin-bottom: 20px;
      }

      #videoPlayer {
        width: 100%;
        height: auto;
        display: block;
        max-height: 500px;
      }

      .video-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
      }

      .control-btn {
        background: linear-gradient(90deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 50px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .control-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
      }

      .control-btn:active {
        transform: translateY(1px);
      }

      .screenshot-area {
        margin-top: 20px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        padding: 20px;
        border: 2px dashed #ddd;
        min-height: 200px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
      }

      .screenshot-area.has-screenshot {
        border-color: #667eea;
        border-style: solid;
      }

      .screenshot-preview {
        max-width: 100%;
        max-height: 300px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        display: none;
      }

      .screenshot-placeholder {
        text-align: center;
        color: #888;
        padding: 20px;
      }

      .screenshot-placeholder i {
        font-size: 3rem;
        margin-bottom: 15px;
        color: #667eea;
        opacity: 0.5;
      }

      .mode-selection {
        margin-bottom: 30px;
      }

      .section-title {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: #667eea;
        border-left: 4px solid #667eea;
        padding-left: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .mode-tabs {
        display: flex;
        background: #f5f5f5;
        border-radius: 12px;
        padding: 5px;
        margin-bottom: 25px;
      }

      .mode-tab {
        flex: 1;
        padding: 15px;
        text-align: center;
        background: transparent;
        border: none;
        color: #666;
        cursor: pointer;
        border-radius: 8px;
        font-size: 1.1rem;
        font-weight: 600;
        transition: all 0.3s ease;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
      }

      .mode-tab.active {
        background: white;
        color: #667eea;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .mode-tab:hover:not(.active) {
        background: rgba(102, 126, 234, 0.1);
      }

      .assistants-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
        margin-bottom: 30px;
      }

      .assistant-category {
        background: #f9f9f9;
        border-radius: 15px;
        padding: 20px;
        border: 1px solid #eee;
      }

      .category-title {
        font-size: 1.2rem;
        margin-bottom: 15px;
        color: #764ba2;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .assistants-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
      }

      .assistant-card {
        background: white;
        border: 2px solid transparent;
        border-radius: 12px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
      }

      .assistant-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        border-color: #667eea;
      }

      .assistant-card.selected {
        border-color: #667eea;
        background: rgba(102, 126, 234, 0.05);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
      }

      .assistant-card.selected::before {
        content: "✓";
        position: absolute;
        top: 10px;
        right: 10px;
        background: #667eea;
        color: white;
        width: 25px;
        height: 25px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }

      .assistant-icon {
        font-size: 2rem;
        margin-bottom: 15px;
        color: #667eea;
      }

      .assistant-name {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
      }

      .assistant-desc {
        font-size: 0.9rem;
        color: #666;
        line-height: 1.4;
      }

      .custom-prompt-container {
        display: none;
        margin-bottom: 30px;
      }

      .custom-prompt-container.active {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .custom-prompt-label {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
        color: #667eea;
      }

      .custom-prompt {
        width: 100%;
        padding: 15px;
        background: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 10px;
        color: #333;
        font-size: 1rem;
        resize: vertical;
        min-height: 120px;
      }

      .custom-prompt:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
      }

      .action-buttons {
        display: flex;
        gap: 15px;
        margin-top: auto;
      }

      .action-btn {
        flex: 1;
        padding: 18px;
        border: none;
        border-radius: 12px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
      }

      .analyze-btn {
        background: linear-gradient(90deg, #667eea, #764ba2);
        color: white;
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .analyze-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
      }

      .analyze-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .reset-btn {
        background: #f5f5f5;
        color: #666;
      }

      .reset-btn:hover {
        background: #eee;
        transform: translateY(-3px);
      }

      .results-container {
        margin-top: 30px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        min-height: 200px;
        max-height: 500px;
        overflow-y: auto;
      }

      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
      }

      .results-title {
        font-size: 1.3rem;
        color: #667eea;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .assistant-indicator {
        background: rgba(102, 126, 234, 0.1);
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.9rem;
        color: #667eea;
        border: 1px solid rgba(102, 126, 234, 0.3);
      }

      .loading {
        display: none;
        text-align: center;
        padding: 40px 20px;
      }

      .loading-spinner {
        border: 5px solid rgba(102, 126, 234, 0.1);
        border-top: 5px solid #667eea;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .result-content {
        line-height: 1.6;
        color: #333;
      }

      .result-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
      }

      .assistant-icon-large {
        font-size: 2.5rem;
        color: #667eea;
      }

      .assistant-info h3 {
        font-size: 1.5rem;
        margin-bottom: 5px;
        color: #667eea;
      }

      .analysis-time {
        font-size: 0.9rem;
        color: #888;
      }

      .analysis-details {
        background: #f9f9f9;
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
      }

      .detail-item {
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 1px solid #eee;
      }

      .detail-item:last-child {
        margin-bottom: 0;
        border-bottom: none;
      }

      .detail-title {
        font-weight: 600;
        color: #764ba2;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .detail-content {
        line-height: 1.5;
        color: #555;
      }

      .tip-box {
        background: #eef5ff;
        padding: 15px;
        border-radius: 10px;
        border-left: 4px solid #667eea;
        margin: 15px 0;
      }

      .highlight {
        background: rgba(102, 126, 234, 0.05);
        padding: 15px;
        border-radius: 10px;
        border-left: 4px solid #764ba2;
        margin: 15px 0;
      }

      .recommendation-list {
        padding-left: 20px;
      }

      .recommendation-list li {
        margin-bottom: 10px;
        color: #555;
      }

      footer {
        text-align: center;
        padding: 20px;
        margin-top: 20px;
        color: white;
        font-size: 0.9rem;
        opacity: 0.9;
      }

      .shortcut-hint {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.9);
        padding: 10px 15px;
        border-radius: 10px;
        font-size: 0.8rem;
        color: #666;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border: 1px solid #eee;
      }

      @media (max-width: 1024px) {
        .main-content {
          flex-direction: column;
        }

        .assistants-grid {
          grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        }
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 2rem;
        }

        .assistants-grid {
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        }

        .action-buttons {
          flex-direction: column;
        }

        .mode-tabs {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>视频理解助手</h1>
        <p class="tagline">暂停一下，AI帮你分析视频内容</p>
        <p class="sub-tagline">
          看视频遇到不明白的地方？暂停一下，让AI助手帮你识别、解释和分析
        </p>
      </header>

      <div class="main-content">
        <section class="video-section">
          <div class="video-container">
            <video id="videoPlayer" controls>
              <source
                src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                type="video/mp4"
              />
              您的浏览器不支持视频播放
            </video>
            <div class="video-controls">
              <div class="video-info">
                <i class="fas fa-play-circle"></i> 播放中 - 示例视频
              </div>
              <button id="screenshotBtn" class="control-btn">
                <i class="fas fa-camera"></i> 截屏并分析
              </button>
            </div>
          </div>

          <div id="screenshotArea" class="screenshot-area">
            <div id="screenshotPlaceholder" class="screenshot-placeholder">
              <i class="fas fa-image"></i>
              <p>截图将显示在这里</p>
              <p style="font-size: 0.9rem; color: #999">
                暂停视频后点击"截屏并分析"按钮
              </p>
            </div>
            <img
              id="screenshotPreview"
              class="screenshot-preview"
              alt="截图预览"
            />
          </div>
        </section>

        <section class="assistant-section">
          <div class="mode-selection">
            <h2 class="section-title">
              <i class="fas fa-robot"></i> 选择AI助手类型
            </h2>

            <div class="mode-tabs">
              <button id="recognitionTab" class="mode-tab active">
                <i class="fas fa-magic"></i> 智能助手
              </button>
              <button id="customTab" class="mode-tab">
                <i class="fas fa-edit"></i> 自定义问题
              </button>
            </div>
          </div>

          <!-- 智能助手区域 -->
          <div id="recognitionAssistants" class="assistants-container">
            <div class="assistant-category">
              <h3 class="category-title">
                <i class="fas fa-eye"></i> 看视频常用
              </h3>
              <div class="assistants-grid">
                <div class="assistant-card" data-assistant="general-explainer">
                  <div class="assistant-icon">
                    <i class="fas fa-info-circle"></i>
                  </div>
                  <div class="assistant-name">视频内容解说</div>
                  <div class="assistant-desc">
                    看不懂在演什么？AI帮你解释场景和剧情
                  </div>
                </div>
                <div
                  class="assistant-card"
                  data-assistant="language-translator"
                >
                  <div class="assistant-icon">
                    <i class="fas fa-language"></i>
                  </div>
                  <div class="assistant-name">外语翻译助手</div>
                  <div class="assistant-desc">
                    识别外语字幕或对话，实时翻译成中文
                  </div>
                </div>
                <div class="assistant-card" data-assistant="object-identifier">
                  <div class="assistant-icon">
                    <i class="fas fa-search"></i>
                  </div>
                  <div class="assistant-name">物品识别助手</div>
                  <div class="assistant-desc">
                    画面里是什么东西？AI告诉你名称和用途
                  </div>
                </div>
                <div class="assistant-card" data-assistant="character-analyzer">
                  <div class="assistant-icon"><i class="fas fa-user"></i></div>
                  <div class="assistant-name">人物识别助手</div>
                  <div class="assistant-desc">
                    这是哪位演员/人物？AI帮你识别和介绍
                  </div>
                </div>
              </div>
            </div>

            <div class="assistant-category">
              <h3 class="category-title">
                <i class="fas fa-graduation-cap"></i> 学习好帮手
              </h3>
              <div class="assistants-grid">
                <div class="assistant-card" data-assistant="lecture-notes">
                  <div class="assistant-icon"><i class="fas fa-book"></i></div>
                  <div class="assistant-name">课程笔记助手</div>
                  <div class="assistant-desc">
                    把教学视频截图变笔记，提取重点知识点
                  </div>
                </div>
                <div class="assistant-card" data-assistant="text-extractor">
                  <div class="assistant-icon"><i class="fas fa-font"></i></div>
                  <div class="assistant-name">文字提取助手</div>
                  <div class="assistant-desc">
                    提取PPT、文档中的文字，方便复习和记录
                  </div>
                </div>
                <div class="assistant-card" data-assistant="math-helper">
                  <div class="assistant-icon">
                    <i class="fas fa-calculator"></i>
                  </div>
                  <div class="assistant-name">数学解题助手</div>
                  <div class="assistant-desc">
                    看不懂数学公式？AI逐步讲解解题方法
                  </div>
                </div>
                <div class="assistant-card" data-assistant="diagram-explainer">
                  <div class="assistant-icon">
                    <i class="fas fa-project-diagram"></i>
                  </div>
                  <div class="assistant-name">图表解释助手</div>
                  <div class="assistant-desc">
                    看不懂图表数据？AI分析趋势和结论
                  </div>
                </div>
              </div>
            </div>

            <div class="assistant-category">
              <h3 class="category-title">
                <i class="fas fa-shopping-cart"></i> 生活小助手
              </h3>
              <div class="assistants-grid">
                <div class="assistant-card" data-assistant="product-identifier">
                  <div class="assistant-icon"><i class="fas fa-tag"></i></div>
                  <div class="assistant-name">商品识别助手</div>
                  <div class="assistant-desc">
                    视频里这是什么商品？AI帮你找同款
                  </div>
                </div>
                <div class="assistant-card" data-assistant="recipe-extractor">
                  <div class="assistant-icon">
                    <i class="fas fa-utensils"></i>
                  </div>
                  <div class="assistant-name">菜谱提取助手</div>
                  <div class="assistant-desc">
                    美食视频截图，AI提取详细菜谱和做法
                  </div>
                </div>
                <div class="assistant-card" data-assistant="travel-guide">
                  <div class="assistant-icon">
                    <i class="fas fa-map-marker-alt"></i>
                  </div>
                  <div class="assistant-name">旅游景点识别</div>
                  <div class="assistant-desc">
                    这是哪里？AI识别景点并介绍相关信息
                  </div>
                </div>
                <div class="assistant-card" data-assistant="fashion-advice">
                  <div class="assistant-icon">
                    <i class="fas fa-tshirt"></i>
                  </div>
                  <div class="assistant-name">穿搭建议助手</div>
                  <div class="assistant-desc">
                    视频里的穿搭怎么样？AI给出搭配建议
                  </div>
                </div>
              </div>
            </div>

            <div class="assistant-category">
              <h3 class="category-title">
                <i class="fas fa-question-circle"></i> 疑惑解答
              </h3>
              <div class="assistants-grid">
                <div class="assistant-card" data-assistant="meme-explainer">
                  <div class="assistant-icon"><i class="fas fa-laugh"></i></div>
                  <div class="assistant-name">网络梗解释</div>
                  <div class="assistant-desc">
                    不懂这个梗什么意思？AI解释背景和用法
                  </div>
                </div>
                <div class="assistant-card" data-assistant="historical-context">
                  <div class="assistant-icon">
                    <i class="fas fa-landmark"></i>
                  </div>
                  <div class="assistant-name">历史背景助手</div>
                  <div class="assistant-desc">
                    历史剧看不懂？AI讲解时代背景和人物关系
                  </div>
                </div>
                <div class="assistant-card" data-assistant="tech-explainer">
                  <div class="assistant-icon">
                    <i class="fas fa-microchip"></i>
                  </div>
                  <div class="assistant-name">科技产品介绍</div>
                  <div class="assistant-desc">
                    这是啥高科技产品？AI详细介绍功能和原理
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 自定义问题区域 -->
          <div id="customAssistant" class="custom-prompt-container">
            <div class="custom-prompt-label">
              <i class="fas fa-question"></i> 有什么想问的？
            </div>
            <textarea
              id="customPrompt"
              class="custom-prompt"
              placeholder="直接问AI你想知道什么，例如：
• 视频里这个人在做什么？
• 这个场景是在哪里拍摄的？
• 画面右下角那个东西是什么？
• 这个菜是怎么做的？
• 这个梗是什么意思？

描述越具体，回答越准确！"
            ></textarea>
          </div>

          <div class="action-buttons">
            <button id="analyzeBtn" class="action-btn analyze-btn" disabled>
              <i class="fas fa-brain"></i> 开始AI分析
            </button>
            <button id="resetBtn" class="action-btn reset-btn">
              <i class="fas fa-redo"></i> 重新开始
            </button>
          </div>
        </section>
      </div>

      <div class="results-container">
        <div class="results-header">
          <div class="results-title">
            <i class="fas fa-comment-alt"></i> AI分析结果
            <div id="assistantIndicator" class="assistant-indicator">
              请先选择助手
            </div>
          </div>
          <div id="analysisStatus">
            <i class="fas fa-clock"></i> 等待分析请求
          </div>
        </div>

        <div id="loading" class="loading">
          <div class="loading-spinner"></div>
          <p>AI助手正在分析中，请稍候...</p>
          <p style="color: #888; font-size: 0.9rem; margin-top: 10px">
            正在根据您选择的助手类型进行针对性分析
          </p>
        </div>

        <div id="resultContent" class="result-content">
          <p style="text-align: center; color: #888; padding: 40px 20px">
            <i
              class="fas fa-robot"
              style="
                font-size: 3rem;
                margin-bottom: 20px;
                display: block;
                color: #667eea;
              "
            ></i>
            使用步骤：<br />
            1. 暂停视频并截图<br />
            2. 选择AI助手类型或直接提问<br />
            3. 点击"开始AI分析"<br />
            <br />
            AI会帮您理解视频中任何不明白的地方！
          </p>
        </div>
      </div>

      <footer>
        <p>
          视频理解助手 &copy; 2023 | 让视频观看更轻松 | AI智能辅助 |
          日常生活好帮手
        </p>
        <p style="font-size: 0.8rem; margin-top: 5px; opacity: 0.8">
          每个助手都针对特定场景优化，回答更准确实用
        </p>
      </footer>

      <div class="shortcut-hint">
        <i class="fas fa-keyboard"></i> 快捷键: 空格播放/暂停 | Ctrl+Enter截屏
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // 获取DOM元素
        const videoPlayer = document.getElementById("videoPlayer");
        const screenshotBtn = document.getElementById("screenshotBtn");
        const screenshotPreview = document.getElementById("screenshotPreview");
        const screenshotPlaceholder = document.getElementById(
          "screenshotPlaceholder"
        );
        const screenshotArea = document.getElementById("screenshotArea");
        const recognitionTab = document.getElementById("recognitionTab");
        const customTab = document.getElementById("customTab");
        const recognitionAssistants = document.getElementById(
          "recognitionAssistants"
        );
        const customAssistant = document.getElementById("customAssistant");
        const assistantCards = document.querySelectorAll(".assistant-card");
        const customPrompt = document.getElementById("customPrompt");
        const analyzeBtn = document.getElementById("analyzeBtn");
        const resetBtn = document.getElementById("resetBtn");
        const loading = document.getElementById("loading");
        const resultContent = document.getElementById("resultContent");
        const analysisStatus = document.getElementById("analysisStatus");
        const assistantIndicator =
          document.getElementById("assistantIndicator");

        // 当前状态
        let currentMode = "recognition"; // 'recognition' 或 'custom'
        let selectedAssistant = null;
        let screenshotData = null;

        // 助手信息映射
        const assistantInfo = {
          "general-explainer": {
            name: "视频内容解说",
            icon: "fas fa-info-circle",
            description: "看不懂在演什么？AI帮你解释场景和剧情",
            category: "看视频常用",
          },
          "language-translator": {
            name: "外语翻译助手",
            icon: "fas fa-language",
            description: "识别外语字幕或对话，实时翻译成中文",
            category: "看视频常用",
          },
          "object-identifier": {
            name: "物品识别助手",
            icon: "fas fa-search",
            description: "画面里是什么东西？AI告诉你名称和用途",
            category: "看视频常用",
          },
          "character-analyzer": {
            name: "人物识别助手",
            icon: "fas fa-user",
            description: "这是哪位演员/人物？AI帮你识别和介绍",
            category: "看视频常用",
          },
          "lecture-notes": {
            name: "课程笔记助手",
            icon: "fas fa-book",
            description: "把教学视频截图变笔记，提取重点知识点",
            category: "学习好帮手",
          },
          "text-extractor": {
            name: "文字提取助手",
            icon: "fas fa-font",
            description: "提取PPT、文档中的文字，方便复习和记录",
            category: "学习好帮手",
          },
          "math-helper": {
            name: "数学解题助手",
            icon: "fas fa-calculator",
            description: "看不懂数学公式？AI逐步讲解解题方法",
            category: "学习好帮手",
          },
          "diagram-explainer": {
            name: "图表解释助手",
            icon: "fas fa-project-diagram",
            description: "看不懂图表数据？AI分析趋势和结论",
            category: "学习好帮手",
          },
          "product-identifier": {
            name: "商品识别助手",
            icon: "fas fa-tag",
            description: "视频里这是什么商品？AI帮你找同款",
            category: "生活小助手",
          },
          "recipe-extractor": {
            name: "菜谱提取助手",
            icon: "fas fa-utensils",
            description: "美食视频截图，AI提取详细菜谱和做法",
            category: "生活小助手",
          },
          "travel-guide": {
            name: "旅游景点识别",
            icon: "fas fa-map-marker-alt",
            description: "这是哪里？AI识别景点并介绍相关信息",
            category: "生活小助手",
          },
          "fashion-advice": {
            name: "穿搭建议助手",
            icon: "fas fa-tshirt",
            description: "视频里的穿搭怎么样？AI给出搭配建议",
            category: "生活小助手",
          },
          "meme-explainer": {
            name: "网络梗解释",
            icon: "fas fa-laugh",
            description: "不懂这个梗什么意思？AI解释背景和用法",
            category: "疑惑解答",
          },
          "historical-context": {
            name: "历史背景助手",
            icon: "fas fa-landmark",
            description: "历史剧看不懂？AI讲解时代背景和人物关系",
            category: "疑惑解答",
          },
          "tech-explainer": {
            name: "科技产品介绍",
            icon: "fas fa-microchip",
            description: "这是啥高科技产品？AI详细介绍功能和原理",
            category: "疑惑解答",
          },
        };

        // 模式选项卡切换
        recognitionTab.addEventListener("click", function () {
          recognitionTab.classList.add("active");
          customTab.classList.remove("active");
          recognitionAssistants.style.display = "flex";
          customAssistant.classList.remove("active");
          currentMode = "recognition";

          // 如果已选择助手，更新分析按钮状态
          updateAnalyzeButtonState();

          console.log(`切换到模式: ${currentMode}`);
        });

        customTab.addEventListener("click", function () {
          customTab.classList.add("active");
          recognitionTab.classList.remove("active");
          recognitionAssistants.style.display = "none";
          customAssistant.classList.add("active");
          currentMode = "custom";

          // 更新选择状态
          selectedAssistant = "custom";
          updateAnalyzeButtonState();
          updateAssistantIndicator();

          console.log(`切换到模式: ${currentMode}`);
        });

        // 助手卡片选择
        assistantCards.forEach((card) => {
          card.addEventListener("click", function () {
            // 移除所有卡片的选中状态
            assistantCards.forEach((c) => c.classList.remove("selected"));

            // 添加当前卡片的选中状态
            this.classList.add("selected");

            // 更新选中的助手
            selectedAssistant = this.getAttribute("data-assistant");

            // 更新分析按钮状态
            updateAnalyzeButtonState();

            // 更新助手指示器
            updateAssistantIndicator();

            console.log(`选择助手: ${selectedAssistant}`);
          });
        });

        // 截屏功能
        screenshotBtn.addEventListener("click", function () {
          // 暂停视频
          videoPlayer.pause();

          // 创建canvas元素用于截屏
          const canvas = document.createElement("canvas");
          canvas.width = videoPlayer.videoWidth;
          canvas.height = videoPlayer.videoHeight;

          const ctx = canvas.getContext("2d");
          ctx.drawImage(videoPlayer, 0, 0, canvas.width, canvas.height);

          // 将canvas转换为图像URL
          const screenshotUrl = canvas.toDataURL("image/png");

          // 显示截图预览
          screenshotPreview.src = screenshotUrl;
          screenshotPreview.style.display = "block";
          screenshotPlaceholder.style.display = "none";
          screenshotArea.classList.add("has-screenshot");

          // 保存截图数据
          screenshotData = screenshotUrl;

          // 更新分析按钮状态
          updateAnalyzeButtonState();

          // 更新状态
          analysisStatus.innerHTML =
            '<i class="fas fa-check-circle" style="color:#4CAF50"></i> 截图已就绪';

          console.log("截图已保存");
        });

        // 更新分析按钮状态
        function updateAnalyzeButtonState() {
          const hasScreenshot = screenshotData !== null;
          const hasSelection =
            currentMode === "recognition"
              ? selectedAssistant !== null
              : currentMode === "custom" && customPrompt.value.trim() !== "";

          analyzeBtn.disabled = !(hasScreenshot && hasSelection);
        }

        // 更新助手指示器
        function updateAssistantIndicator() {
          if (
            currentMode === "recognition" &&
            selectedAssistant &&
            assistantInfo[selectedAssistant]
          ) {
            assistantIndicator.textContent =
              assistantInfo[selectedAssistant].name;
            assistantIndicator.style.display = "inline-block";
          } else if (currentMode === "custom") {
            assistantIndicator.textContent = "自定义问题";
            assistantIndicator.style.display = "inline-block";
          } else {
            assistantIndicator.textContent = "请先选择助手";
            assistantIndicator.style.display = "inline-block";
          }
        }

        // 自定义提示词输入监听
        customPrompt.addEventListener("input", function () {
          updateAnalyzeButtonState();
        });

        // 开始分析
        analyzeBtn.addEventListener("click", function () {
          if (analyzeBtn.disabled) return;

          // 验证输入
          if (currentMode === "custom" && !customPrompt.value.trim()) {
            alert("请输入您的问题！");
            return;
          }

          // 显示加载动画
          loading.style.display = "block";
          resultContent.innerHTML = "";
          analysisStatus.innerHTML =
            '<i class="fas fa-spinner fa-spin"></i> AI正在分析...';

          // 模拟API请求延迟
          setTimeout(performAnalysis, 1500);
        });

        // 模拟分析函数
        function performAnalysis() {
          // 获取助手信息
          let assistantName, assistantIcon, assistantDesc;

          if (
            currentMode === "recognition" &&
            selectedAssistant &&
            assistantInfo[selectedAssistant]
          ) {
            assistantName = assistantInfo[selectedAssistant].name;
            assistantIcon = assistantInfo[selectedAssistant].icon;
            assistantDesc = assistantInfo[selectedAssistant].description;
          } else {
            assistantName = "自定义问题解答";
            assistantIcon = "fas fa-question-circle";
            assistantDesc = "针对您的问题进行详细解答";
          }

          // 生成模拟分析结果
          let analysisResult = generateMockAnalysis(
            selectedAssistant || "custom"
          );

          // 构建结果HTML
          const resultHTML = `
                    <div class="result-header">
                        <div class="assistant-icon-large"><i class="${assistantIcon}"></i></div>
                        <div class="assistant-info">
                            <h3>${assistantName}</h3>
                            <p>${assistantDesc}</p>
                            <p class="analysis-time"><i class="fas fa-clock"></i> ${new Date().toLocaleTimeString()} 分析完成</p>
                        </div>
                    </div>
                    
                    <div class="analysis-details">
                        <div class="detail-item">
                            <div class="detail-title"><i class="fas fa-comment"></i> AI分析结果</div>
                            <div class="detail-content">
                                <div class="tip-box">
                                    ${analysisResult.summary}
                                </div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="detail-title"><i class="fas fa-lightbulb"></i> 详细解答</div>
                            <div class="detail-content">
                                ${analysisResult.details}
                            </div>
                        </div>
                        
                        ${
                          analysisResult.tips
                            ? `
                        <div class="detail-item">
                            <div class="detail-title"><i class="fas fa-star"></i> 实用小贴士</div>
                            <div class="detail-content">
                                <ul class="recommendation-list">
                                    ${analysisResult.tips
                                      .map((tip) => `<li>${tip}</li>`)
                                      .join("")}
                                </ul>
                            </div>
                        </div>
                        `
                            : ""
                        }
                        
                        <div class="detail-item">
                            <div class="detail-title"><i class="fas fa-info-circle"></i> 相关信息</div>
                            <div class="detail-content">
                                <div class="highlight">
                                    <p><strong>分析类型：</strong> ${
                                      analysisResult.type
                                    }</p>
                                    <p><strong>准确度评估：</strong> ${
                                      analysisResult.accuracy
                                    }</p>
                                    <p><strong>后续建议：</strong> ${
                                      analysisResult.suggestion
                                    }</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; color: #888; font-size: 0.9rem;">
                        <i class="fas fa-robot"></i> 本次分析使用了专门优化的AI模型，回答更贴近日常生活需求
                    </div>
                `;

          // 隐藏加载动画，显示结果
          loading.style.display = "none";
          resultContent.innerHTML = resultHTML;
          analysisStatus.innerHTML = `<i class="fas fa-check-circle" style="color:#4CAF50"></i> 分析完成 (${assistantName})`;

          console.log(`分析完成: ${assistantName}`);
        }

        // 生成模拟分析结果
        function generateMockAnalysis(assistantType) {
          const mockResults = {
            "general-explainer": {
              summary:
                "根据画面分析，这是一个卡通动画场景，主角是一只兔子，正在森林中与其他动物互动。",
              details:
                "画面显示一只白色的大兔子（可能是主角Bunny）在绿色的森林环境中。背景有树木和草地，光线明亮自然，营造出欢快的氛围。从兔子的表情和姿态来看，它似乎正在享受户外活动，可能是动画片中的轻松愉快场景。",
              tips: [
                "这类动画通常适合全家观看，内容轻松有趣",
                "如果对剧情有疑问，可以多截几张图连续分析",
                '可以尝试使用"人物识别助手"了解更多角色信息',
              ],
              type: "视频内容解说",
              accuracy: "高准确度（基于场景特征识别）",
              suggestion:
                "如果需要更详细的剧情分析，建议截取包含更多角色互动的画面",
            },
            "language-translator": {
              summary: "画面中检测到英文文字，已为您翻译成中文。",
              details:
                '原句："Big Buck Bunny" → 中文翻译："大雄兔邦尼"<br><br>这是视频的标题，指的是一只名为邦尼的大雄兔。这是一个著名的开源动画短片，常用于演示视频播放技术。',
              tips: [
                "长按截图可以保存翻译结果",
                "如果需要翻译对话，请确保截图包含字幕",
                "系统支持多种语言互译",
              ],
              type: "外语翻译",
              accuracy: "非常高（标题翻译准确）",
              suggestion: "如果视频中有对话，建议在说话时暂停截屏",
            },
            "object-identifier": {
              summary:
                "识别到主要物体：兔子（哺乳动物）、树木（植物）、草地（自然景观）。",
              details:
                "1. <strong>兔子</strong>：白色大型兔子，属于卡通形象，具有拟人化特征<br>2. <strong>树木</strong>：绿色阔叶树，可能是橡树或枫树，卡通风格<br>3. <strong>草地</strong>：绿色的草坪，有深浅不一的绿色表现光影效果<br>4. <strong>背景</strong>：蓝天和白云，表现晴朗天气",
              tips: [
                "可以点击物体名称查看更多详细信息",
                "想知道某物的用途？试试问自定义问题",
                "识别结果可以导出保存",
              ],
              type: "物体识别",
              accuracy: "高（主要物体识别准确）",
              suggestion: "对特定物体感兴趣？可以放大截图或截取特写镜头",
            },
            "recipe-extractor": {
              summary: "识别到一道美食，可能是西式甜点或沙拉。",
              details:
                "虽然当前画面是动画场景，但如果这是美食视频截图，AI可以：<br><br>1. <strong>识别食材</strong>：分析画面中的各种食材<br>2. <strong>提取步骤</strong>：从视频中总结烹饪步骤<br>3. <strong>提供技巧</strong>：分享烹饪小贴士和注意事项<br>4. <strong>营养信息</strong>：估算菜品的热量和营养价值",
              tips: [
                "截取食材特写镜头识别更准确",
                "包含文字说明的截图有助于提取精确菜谱",
                "可以询问替代食材或简化做法",
              ],
              type: "菜谱提取",
              accuracy: "中（需要更多画面信息）",
              suggestion: "请截取包含食材和制作步骤的画面，分析会更准确",
            },
            custom: {
              summary:
                customPrompt.value.trim() || "根据您的自定义问题进行详细分析",
              details:
                "针对您的问题，AI进行了全面分析。从截图来看，这是一个卡通动画场景，包含自然环境和小动物角色。画面色彩鲜艳，风格轻松愉快，适合各年龄段观众观看。",
              tips: [
                "问题越具体，回答越精准",
                "可以尝试用不同助手分析同一画面",
                "分析结果可以复制或分享",
              ],
              type: "自定义问题解答",
              accuracy: "中（依赖问题明确程度）",
              suggestion:
                '下次可以试试："画面左边那个是什么？"或"这个场景表达了什么情绪？"',
            },
          };

          // 返回对应助手的结果，如果没有则返回自定义结果
          return mockResults[assistantType] || mockResults["custom"];
        }

        // 重置功能
        resetBtn.addEventListener("click", function () {
          // 重置截图
          screenshotPreview.style.display = "none";
          screenshotPlaceholder.style.display = "block";
          screenshotArea.classList.remove("has-screenshot");
          screenshotData = null;

          // 重置助手选择
          assistantCards.forEach((card) => card.classList.remove("selected"));
          selectedAssistant = null;

          // 重置自定义输入
          customPrompt.value = "";

          // 重置分析结果
          resultContent.innerHTML = `
                    <p style="text-align: center; color: #888; padding: 40px 20px;">
                        <i class="fas fa-robot" style="font-size: 3rem; margin-bottom: 20px; display: block; color: #667eea;"></i>
                        使用步骤：<br>
                        1. 暂停视频并截图<br>
                        2. 选择AI助手类型或直接提问<br>
                        3. 点击"开始AI分析"<br>
                        <br>
                        AI会帮您理解视频中任何不明白的地方！
                    </p>
                `;
          analysisStatus.innerHTML =
            '<i class="fas fa-clock"></i> 等待分析请求';

          // 重置模式
          recognitionTab.click();

          // 更新按钮状态
          updateAnalyzeButtonState();
          updateAssistantIndicator();

          console.log("系统已重置");
        });

        // 视频控制快捷键
        document.addEventListener("keydown", function (e) {
          // 空格键暂停/播放
          if (
            e.code === "Space" &&
            e.target.tagName !== "TEXTAREA" &&
            e.target.tagName !== "INPUT"
          ) {
            e.preventDefault();
            if (videoPlayer.paused) {
              videoPlayer.play();
            } else {
              videoPlayer.pause();
            }
          }

          // Ctrl+Enter 截屏
          if (e.ctrlKey && e.code === "Enter") {
            e.preventDefault();
            screenshotBtn.click();
          }
        });

        // 初始化助手指示器
        updateAssistantIndicator();
      });
    </script>
  </body>
</html>
